@startuml
title 02_form_import_sequence
autoactivate on
actor Admin
participant "CLI Tool" as CLI
participant "API Gateway" as API
participant "Forms Service" as Svc
database "DB:FormRegistry" as DB

Admin -> CLI: scp forms:import -f forms.yaml
    CLI -> CLI: Parse & Validate YAML
    CLI -> API: Upload Script
        API -> Svc: Import(Script, Tenant)
            Svc -> Svc: Validate Schema & Permissions
            loop For Each Form
                Svc -> DB: Find(FormKey, Tenant)
                return ExistingRecord
                alt Not Found
                    Svc -> DB: Create(Version 1)
                else Content Changed
                    Svc -> DB: Create(Version N+1)
                else Identical
                    Svc -> Svc: No-Op
                end
            end
            Svc -> DB: LogImport(User, Timestamp)
        return Report (JSON)
    return Success (Report)
return Exit Code 0
@enduml

' TRACE:
' SPEC: 06-platform-core/13-form-scripting.md
' Scope: Form Script Import Pipeline
' Last aligned: 2026-01-14
